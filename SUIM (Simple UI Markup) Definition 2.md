SUIM (Simple UI Markup) Definition 2.0SUIM is a performance-first, deterministic UI markup language designed for game engines (Stride) and desktop-grade applications. It utilizes a top-down, single-pass layout architecture ($O(N)$) to ensure zero layout jitter and maximum rendering speed.1. Project Structure & ConventionsSUIM follows a "Convention-over-Configuration" directory model to resolve dependencies automatically:/Shared: Contains global .suim files. Any <style> or <model> defined here is automatically available to all other files in the project./Components: Reusable .suim files. The filename becomes a custom tag (e.g., MyButton.suim is used as <MyButton />)./Pages: Full-screen UI definitions. These are the entry points for the UI engine.2. Layout Philosophy & The Box ModelAbsolute Determinism: Parent dimensions are oncalculated before children are processed. Children never expand parents.The Box Model: Every element is a rectangle. Spacing is governed by margin (outside) and padding (inside).Single-Pass: Layout is computed in one top-down traversal.2.1 Sizing UnitsIntegers: Fixed pixel values (e.g., width="100").rem: Multiplier of the global root font size (e.g., 2rem).pw / ph: Percentage of Parent Width or Parent Height (e.g., 50pw).Star (*): Proportional sharing of remaining space (e.g., 1*, 2*).auto: Resolves to a pre-defined constant in the ThemeMetricTable (e.g., a button's default height).3. Control Flow (Razor-style)Control flow is evaluated during the Expansion Pass (before layout).Conditional Chaining:@if (condition) { ... } else if (other) { ... } else { ... }Switch Statement:@switch (value) { case "A": { ... } default: { ... } }Loops:@foreach (var item in list) { ... }4. Structural Tags<div>: Absolute coordinate container. Supports x, y.<stack>: Sequential container.<vstack>: Vertical stack (alias: <vbox>).<hstack>: Horizontal stack (alias: <hbox>).Attributes: spacing (gap between items).<grid>: Matrix layout.Attributes: columns, rows, spacing.Child Attributes: grid.row, grid.column, grid.rowspan, grid.columnspan.<dock>: Edge-pinning container.Attributes: lastchildfill (default true).Child Attributes: dock.edge (top, bottom, left, right).<overlay>: Forces itself to parent size. Always renders on the highest global layer, ignoring z-index, and intercepts all input.5. Content TagsInteractive: <button>, <input>, <textarea>, <select>, <option>, <progress>.Text: <h1> through <h6>, <p>, <label>.Data/Style:<model>: Defines JSON data for local use.<style>: Defines reusable CSS-like classes.6. Binding & Event HandlersSUIM uses a delegate-based system for C# interaction.6.1 Property Binding (@)Prefixing an attribute with @ (e.g., text="@playerName") registers:Setter: Action<object> to push data to UI.Getter: Func<object> to pull data from UI.Change Handler: Action<object> for two-way synchronization.6.2 Event HandlersSupports standard HTML-style event attributes with function expressions.Events: onclick, onchange, onmouseover, onmouseout, onmouseleave, onfocus, onblur.Syntax: onclick="methodName(this, 10, 'string', targetId)"this: Passes the current element instance.targetId: Passes the instance of the element with id="targetId".7. Global Z-Index & Layeringz-index acts as a global "layer" value.The engine maintains a global draw list sorted by z-index.Elements with higher z-index render on top of lower ones, regardless of their position in the XML tree.Exception: <overlay> tags always render above all z-index layers.8. The "scroll" Attribute TransformationApplying scroll="vertical" or scroll="horizontal" to any tag triggers a structural "desugar" during the Expansion Pass:The original tag is wrapped in a <scrollbar> (the viewport).The viewport inherits all styling (bg, borders, padding, size) from the original tag.The original tag becomes the content child inside the viewport.8.1 Scroll Sizing RulesTo maintain $O(N)$ performance:Default Assumption: If the first child has no size, it is assumed to be 1rem.Inheritance: Subsequent children without explicit sizes automatically inherit the size of the previous sibling.9. Execution PipelineExpansion Pass:Scan /Shared for global styles/models.Resolve @if, @switch, and @foreach.Expand Components (/Components) into the tree.Apply scroll desugaring.Resolution Pass:Resolve rem, pw/ph, and auto into pixel constants via ThemeMetricTable.Layout Pass:Calculate x, y, width, height for every element in a single top-down pass.Render/Bind:Generate the global draw list (sorted by z-index).Hook up delegates for @ bindings and event handlers.